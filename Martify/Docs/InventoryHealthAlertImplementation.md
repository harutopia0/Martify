# C?nh Báo S?c Kh?e T?n Kho - Implementation Guide

## T?ng Quan

Thay v? c?nh báo d?a trên ngày h?t h?n, h? th?ng gi? ðây c?nh báo v? **s?c kh?e t?n kho** - hai v?n ð? quan tr?ng nh?t c?a siêu th? mini:
1. **Không có hàng ð? bán** (S?p h?t hàng)
2. **Hàng ð? m?i không bán ðý?c** (T?n kho lâu)

## Các Lo?i C?nh Báo

### A. C?nh Báo "S?p H?t Hàng" (Low Stock Alert) - Ýu tiên cao ??

**Logic:**
```
S? lý?ng t?n kho ? 10 (Ngý?ng t?i thi?u)
```

**? ngh?a:**
- S?n ph?m ðang ch?m ðáy, c?n nh?p thêm ngay
- Tránh t?nh tr?ng h?t hàng m?t khách

**Hi?n th?:**
- Tiêu ð?: "S?p h?t hàng"
- Màu s?c: Ð? (#F44336)
- Icon: TrendingDown (M?i tên ði xu?ng)
- Background: H?ng nh?t (#FFEBEE)

**Code Logic:**
```csharp
const int MIN_STOCK_THRESHOLD = 10;
SoSanPhamSapHet = _dbContext.Products.Count(p => 
    p.StockQuantity > 0 && 
    p.StockQuantity <= MIN_STOCK_THRESHOLD);
```

### B. C?nh Báo "T?n Kho Lâu" (Slow Moving Stock) - C?nh báo r?i ro ??

**Logic:**
```
S?n ph?m có t?n kho > 0 NHÝNG không có ðõn hàng nào trong 30 ngày qua
```

**? ngh?a:**
- Hàng n?m im = "ti?n ch?t"
- C?n làm chýõng tr?nh khuy?n m?i, x? hàng
- Ho?c ng?ng nh?p lo?i s?n ph?m này

**Hi?n th?:**
- Tiêu ð?: "T?n kho lâu"
- Màu s?c: Cam (#FF9800)
- Icon: ClockAlert (Ð?ng h? c?nh báo)
- Background: Cam nh?t (#FFF3E0)

**Code Logic:**
```csharp
const int SLOW_MOVING_DAYS = 30;
var thirtyDaysAgo = DateTime.Today.AddDays(-SLOW_MOVING_DAYS);

// L?y danh sách s?n ph?m ð? bán trong 30 ngày
var recentlyOrderedProductIds = _dbContext.InvoiceDetails
    .Include(id => id.Invoice)
    .Where(id => id.Invoice.CreatedDate >= thirtyDaysAgo)
    .Select(id => id.ProductID)
    .Distinct()
    .ToList();

// Ð?m s?n ph?m t?n kho nhýng không có trong danh sách v?a bán
SoSanPhamTonKhoLau = _dbContext.Products
    .Where(p => p.StockQuantity > 0 && 
                !recentlyOrderedProductIds.Contains(p.ProductID))
    .Count();
```

## UI Design

### Layout Structure
```
???????????????????????????????????????
? ?? C?nh Báo                         ?
???????????????????????????????????????
? ??????????????????????????????????? ?
? ? ?? S?p h?t hàng            05   ? ? <- Ð?
? ??????????????????????????????????? ?
? ??????????????????????????????????? ?
? ? ? T?n kho lâu             12   ? ? <- Cam
? ??????????????????????????????????? ?
?                                     ?
?   Click ð? xem chi ti?t             ?
???????????????????????????????????????
```

### Color Scheme
- **S?p h?t hàng:**
  - Background: `#FFEBEE` (H?ng nh?t)
  - Text: `#D32F2F` (Ð? ð?m)
  - Number: `#F44336` (Ð?)
  
- **T?n kho lâu:**
  - Background: `#FFF3E0` (Cam nh?t)
  - Text: `#F57C00` (Cam ð?m)
  - Number: `#FF9800` (Cam)

## Tính Nãng Týõng Lai

### 1. Click ð? xem chi ti?t
Khi click vào th? C?nh Báo, hi?n th?:
- **Popup/Dialog** v?i danh sách chi ti?t các s?n ph?m
- Cho phép l?c theo lo?i c?nh báo
- Các hành ð?ng nhanh: Nh?p hàng, Xem chi ti?t s?n ph?m

### 2. Tùy ch?nh ngý?ng
Cho phép admin c?u h?nh:
- Ngý?ng t?i thi?u (MIN_STOCK_THRESHOLD) theo t?ng lo?i s?n ph?m
- S? ngày không bán ð? coi là "t?n kho lâu" (SLOW_MOVING_DAYS)

### 3. Thông báo ch? ð?ng
- Push notification khi có s?n ph?m s?p h?t hàng
- Email báo cáo hàng tu?n v? t?n kho ch?m luân chuy?n

## Files Changed

1. **Dashboard.xaml**
   - Redesigned Alert card v?i 2 sections
   - Added visual indicators (icons, colors)
   - Added "Click ð? xem chi ti?t" hint

2. **DashboardVM.cs**
   - Added `SoSanPhamSapHet` property
   - Added `SoSanPhamTonKhoLau` property
   - Updated `LoadQuickOverview()` v?i logic tính toán m?i

## L?i Ích

? **Qu?n l? t?n kho ch? ð?ng**
- Bi?t trý?c khi nào c?n nh?p hàng
- Phát hi?n s?m hàng ?

? **T?i ýu v?n lýu ð?ng**
- Tránh v?n b? "ðóng bãng" trong hàng t?n
- Gi?m r?i ro hàng ?

? **Tãng hi?u su?t kinh doanh**
- Luôn có hàng ð? bán
- X? l? k?p th?i hàng ch?m luân chuy?n

## Ghi Chú

- Ngý?ng t?i thi?u (10) có th? ði?u ch?nh tùy theo quy mô c?a hàng
- Th?i gian "t?n kho lâu" (30 ngày) có th? thay ð?i theo chu k? kinh doanh
- Nên thêm màn h?nh chi ti?t ð? xem danh sách s?n ph?m c? th?
